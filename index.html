<!DOCTYPE html>
<html>

<style>
  #myContainer {
    width: 250px;
    height: 400px;
    position: relative;
    background: yellow;
  }

  .rect {
    width: 50px;
    height: 50px;
    position: absolute;
    top: -110px;
    background-color: red;
  }

  .col1 {
    left: 0px;
  }

  .col2 {
    left: 50px;
  }

  .col3 {
    left: 100px;
  }

  .col4 { 
    left: 150px;
  }

  .col5 {
    left: 200px;
  }
</style>

<body>
  <div id ="myContainer">
  </div>

  <p>
    <button onclick="myMove()">Click Me</button>

  </p>

  <p>vous avez <span id="affichePoint">0</span></p>
  <p>cliquer sur les rectangles pour les faire disparaitre et gagner des points</p>


  <script>

    let idRect = 1
    let id = null;
    let point = 0;
    let interval;
    let t = 200

    function myMove() {
      let rect = document.querySelectorAll(".rect")
      let pos = -60;

      clearInterval(id);
      requestAnimationFrame(frame);

      function frame() {
        let rect = document.querySelectorAll(".rect")
        if (pos == 450) {
          pos = -100
        } else {
          pos++;
          for (const rectangle of rect) {
            const posRect = parseInt(rectangle.style.top.split("px")[0]) + 2 + "px"
            rectangle.style.top = posRect
          }
        }
        requestAnimationFrame(frame);
      }
    }

    function changeTimer(){
      t = Math.floor(Math.random() * (1000 - 500 + 1)) + 500
    }

    

    const createBrick = () => {
      clearInterval(interval);
      let newdiv = document.createElement("div");
      newdiv.setAttribute("class", 'col' + String(Math.floor(Math.random() * (5 - 1 + 1)) + 1))
      newdiv.className += ' rect'
      newdiv.style.top = '-110px'
      newdiv.style.height = Math.floor(Math.random() * (100 - 50 + 1)) + 50 + "px"
      newdiv.id = 'rect-' + idRect
      const toRemove = 'remove(' + this + ')'
      newdiv.setAttribute('onclick','remove(' + "'" + 'rect-' + idRect + "'" +')')
      
      document.getElementById('myContainer').append(newdiv)
      idRect +=1

      changeTimer();
      interval = setInterval(createBrick, t);
    }

    createBrick()

    function remove(el) {
  		var element = document.getElementById(el);
      if (element.classList.contains("col1")) {
        new Audio('mouton.mp3').play();
      } else if (element.classList.contains("col2")) {
        new Audio('chevre.mp3').play();
      } else if (element.classList.contains("col3")) {
        new Audio('cheval.mp3').play();
      } else if (element.classList.contains("col4")) {
        new Audio('sophie.mp3').play();
      } else if (element.classList.contains("col5")) {
        new Audio('cochon.mp3').play();
      }
  		element.remove();
      point++
      document.getElementById('affichePoint').innerHTML = point
	  }

  </script>

</body>
</html>